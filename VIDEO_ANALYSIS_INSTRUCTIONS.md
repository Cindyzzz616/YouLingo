# Video analysis instructions

## Sampling notes

- why isn't 20 transcribed?
- why isn't 30 transcribed?
--- still isn't transcribed at 0.2 no speech prob threshold


## File structure

There are three types of objects: Video, User and Word.
test_object contains pickled Video and User objects.

Folders:

- audios: audios extracted from individual videos
- videos: individual videos
- sampled_videos: 1000 trending tiktok videos from 2021
- sampled_audios: audios extracted from sampled videos

## Video attributes

- Transcript (native Whisper format and full text)
- Length (duration in seconds)
- Speech length (duration of speech)
- Tokens (a list of Word objects that represents the tokens in the video)
- Types (a list of Word objects that represents the types/unique words in the video)
- Word count
- Words per minute (wpm) - calculated based on speech duration
- Syllables per minute (spm)
- Average PTR

## User attributes

- Vocabulary size
- Lexicon (based on frequency lists + vocabulary size for now)
- Native language (L1)
- Phonetic inventory (sounds they know from native language)

## User + video attributes
- Lexical coverage
- Phonetic coverage

## Modification features

- google_translate and translate: Translate the text of a transcript into a user's native language
- insert_pauses: Insert pauses of specified durations between sentences
- adjust_speech_rate: Adjust the speed of a video to a specified wpm, spm, duration or by a specified factor

## TODOs

- [x] fix language_code
- [ ] fix syntax parsing (not super necessary though for the tiktok random sampling)
- [x] add mean sentence length attribute 
- [ ] (and other ones from here: [text](https://chatgpt.com/share/6899654a-fa3c-8010-b05f-924e6585c457))
- [ ] add proximity of native language's language family to target language?
- [ ] add lexical profile if we're doing sampling on just the videos (need to be able to calculate lexical coverage for any user)
- [ ] when recognizing transcripts, add something to check whether the video has speech and what language the speech is in... or basically detect all the properties in my tiktok resampling table; or check confidence of recognition for each segment
- [ ] add music detection
- [ ] background noise levels?
- [ ] handle code switching somehow
- [x] fix calculate ptr stuff in Video
- [x] get better corpus for word frequency (or just deal with contractions and apostrophes in general, and count by word families not words)
- [x] handle contractions!!!
- [x] add speaker diarization to get number of speakers in a video
- [ ] fix pitch issue after adjusting speed
- [x] phonological neighbours
- [x] FL (NOTE: we can also see how often a specific user confuses two phonemes in transcription exercises - and make a confusion matrix based on that; can also combine FL and phonetic overlap - if a word has a sound with high FL, but that sound/distinction is in the user's L1 inventory, then it's probably less likely to be confused than otherwise)

## Metrics to potentially add

- type-token ratio of a video
- average syllable count of words in a video (syllable/word)
- count word frequency by word *families* - DONE

## Sample whisper transcription output

{'segments': [Segment(id=1, seek=0, start=0.0, end=2.08, text=" If you think you're good with words, listen up.", tokens=[50364, 759, 291, 519, 291, 434, 665, 365, 2283, 11, 2140, 493, 13, 50468], avg_logprob=-0.14357638670728098, compression_ratio=1.7039106145251397, no_speech_prob=0.011335337534546852, words=None, temperature=0.0), Segment(id=2, seek=0, start=2.08, end=4.84, text=" Let's talk about how you can improve linguistic intelligence.", tokens=[50468, 961, 311, 751, 466, 577, 291, 393, 3470, 43002, 7599, 13, 50606], avg_logprob=-0.14357638670728098, compression_ratio=1.7039106145251397, no_speech_prob=0.011335337534546852, words=None, temperature=0.0), Segment(id=3, seek=0, start=4.84, end=6.640000000000001, text=' Firstly, simple but reading.', tokens=[50606, 20042, 11, 2199, 457, 3760, 13, 50696], avg_logprob=-0.14357638670728098, compression_ratio=1.7039106145251397, no_speech_prob=0.011335337534546852, words=None, temperature=0.0), Segment(id=4, seek=0, start=6.640000000000001, end=8.64, text=' Engaging a variety of different texts,', tokens=[50696, 2469, 3568, 257, 5673, 295, 819, 15765, 11, 50796], avg_logprob=-0.14357638670728098, compression_ratio=1.7039106145251397, no_speech_prob=0.011335337534546852, words=None, temperature=0.0), Segment(id=5, seek=0, start=8.64, end=10.68, text=' like articles, poetry, books.', tokens=[50796, 411, 11290, 11, 15155, 11, 3642, 13, 50898], avg_logprob=-0.14357638670728098, compression_ratio=1.7039106145251397, no_speech_prob=0.011335337534546852, words=None, temperature=0.0), Segment(id=6, seek=0, start=10.68, end=13.36, text=' Because that will enhance your vocabulary, comprehension,', tokens=[50898, 1436, 300, 486, 11985, 428, 19864, 11, 44991, 11, 51032], avg_logprob=-0.14357638670728098, compression_ratio=1.7039106145251397, no_speech_prob=0.011335337534546852, words=None, temperature=0.0), Segment(id=7, seek=0, start=13.36, end=16.080000000000002, text=' and just really expose you to a lot of different writing styles.', tokens=[51032, 293, 445, 534, 19219, 291, 281, 257, 688, 295, 819, 3579, 13273, 13, 51168], avg_logprob=-0.14357638670728098, compression_ratio=1.7039106145251397, no_speech_prob=0.011335337534546852, words=None, temperature=0.0), Segment(id=8, seek=0, start=16.080000000000002, end=17.12, text=' Secondly, writing.', tokens=[51168, 19483, 11, 3579, 13, 51220], avg_logprob=-0.14357638670728098, compression_ratio=1.7039106145251397, no_speech_prob=0.011335337534546852, words=None, temperature=0.0), Segment(id=9, seek=0, start=17.12, end=18.68, text=' Just try to write regularly,', tokens=[51220, 1449, 853, 281, 2464, 11672, 11, 51298], avg_logprob=-0.14357638670728098, compression_ratio=1.7039106145251397, no_speech_prob=0.011335337534546852, words=None, temperature=0.0), Segment(id=10, seek=0, start=18.68, end=20.84, text=" whether it's creative writing, informative writing,", tokens=[51298, 1968, 309, 311, 5880, 3579, 11, 27759, 3579, 11, 51406], avg_logprob=-0.14357638670728098, compression_ratio=1.7039106145251397, no_speech_prob=0.011335337534546852, words=None, temperature=0.0), Segment(id=11, seek=0, start=20.84, end=23.2, text=' journaling, whatever it is, just write.', tokens=[51406, 17598, 4270, 11, 2035, 309, 307, 11, 445, 2464, 13, 51524], avg_logprob=-0.14357638670728098, compression_ratio=1.7039106145251397, no_speech_prob=0.011335337534546852, words=None, temperature=0.0), Segment(id=12, seek=0, start=23.2, end=25.080000000000002, text=' Because writing will help you with articulation', tokens=[51524, 1436, 3579, 486, 854, 291, 365, 15228, 2776, 51618], avg_logprob=-0.14357638670728098, compression_ratio=1.7039106145251397, no_speech_prob=0.011335337534546852, words=None, temperature=0.0), Segment(id=13, seek=0, start=25.080000000000002, end=27.2, text=' and also structuring your thoughts more coherently.', tokens=[51618, 293, 611, 6594, 1345, 428, 4598, 544, 26528, 2276, 13, 51724], avg_logprob=-0.14357638670728098, compression_ratio=1.7039106145251397, no_speech_prob=0.011335337534546852, words=None, temperature=0.0), Segment(id=14, seek=0, start=27.2, end=29.560000000000002, text=' Third is a bit silly, but reward games.', tokens=[51724, 12548, 307, 257, 857, 11774, 11, 457, 7782, 2813, 13, 51842], avg_logprob=-0.14357638670728098, compression_ratio=1.7039106145251397, no_speech_prob=0.011335337534546852, words=None, temperature=0.0), Segment(id=15, seek=2956, start=29.560000000000002, end=31.800000000000004, text=' Things like scrubble or crossword puzzles', tokens=[50364, 9514, 411, 24163, 638, 420, 3278, 7462, 24138, 50476], avg_logprob=-0.13410686586911863, compression_ratio=1.725552050473186, no_speech_prob=0.00020127756579313427, words=None, temperature=0.0), Segment(id=16, seek=2956, start=31.800000000000004, end=33.84, text=' because they can simulate word knowledge', tokens=[50476, 570, 436, 393, 27817, 1349, 3601, 50578], avg_logprob=-0.13410686586911863, compression_ratio=1.725552050473186, no_speech_prob=0.00020127756579313427, words=None, temperature=0.0), Segment(id=17, seek=2956, start=33.84, end=35.28, text=' and also very quick thinking.', tokens=[50578, 293, 611, 588, 1702, 1953, 13, 50650], avg_logprob=-0.13410686586911863, compression_ratio=1.725552050473186, no_speech_prob=0.00020127756579313427, words=None, temperature=0.0), Segment(id=18, seek=2956, start=35.28, end=37.480000000000004, text=' Fourthly, public speaking or debating', tokens=[50650, 23773, 356, 11, 1908, 4124, 420, 40647, 50760], avg_logprob=-0.13410686586911863, compression_ratio=1.725552050473186, no_speech_prob=0.00020127756579313427, words=None, temperature=0.0), Segment(id=19, seek=2956, start=37.480000000000004, end=38.84, text=' can be very useful for you.', tokens=[50760, 393, 312, 588, 4420, 337, 291, 13, 50828], avg_logprob=-0.13410686586911863, compression_ratio=1.725552050473186, no_speech_prob=0.00020127756579313427, words=None, temperature=0.0), Segment(id=20, seek=2956, start=38.84, end=41.08, text=' As public speaking or debating,', tokens=[50828, 1018, 1908, 4124, 420, 40647, 11, 50940], avg_logprob=-0.13410686586911863, compression_ratio=1.725552050473186, no_speech_prob=0.00020127756579313427, words=None, temperature=0.0), Segment(id=21, seek=2956, start=41.08, end=42.92, text=' really help you articulate your thoughts', tokens=[50940, 534, 854, 291, 30305, 428, 4598, 51032], avg_logprob=-0.13410686586911863, compression_ratio=1.725552050473186, no_speech_prob=0.00020127756579313427, words=None, temperature=0.0), Segment(id=22, seek=2956, start=42.92, end=45.440000000000005, text=' well, concise, and clear in front of others.', tokens=[51032, 731, 11, 44882, 11, 293, 1850, 294, 1868, 295, 2357, 13, 51158], avg_logprob=-0.13410686586911863, compression_ratio=1.725552050473186, no_speech_prob=0.00020127756579313427, words=None, temperature=0.0), Segment(id=23, seek=2956, start=45.440000000000005, end=47.160000000000004, text=' And try learning new languages.', tokens=[51158, 400, 853, 2539, 777, 8650, 13, 51244], avg_logprob=-0.13410686586911863, compression_ratio=1.725552050473186, no_speech_prob=0.00020127756579313427, words=None, temperature=0.0), Segment(id=24, seek=2956, start=47.160000000000004, end=49.6, text=' That will just expand your linguistic capacity.', tokens=[51244, 663, 486, 445, 5268, 428, 43002, 6042, 13, 51366], avg_logprob=-0.13410686586911863, compression_ratio=1.725552050473186, no_speech_prob=0.00020127756579313427, words=None, temperature=0.0), Segment(id=25, seek=2956, start=49.6, end=51.6, text=' In order to improve your linguistic intelligence,', tokens=[51366, 682, 1668, 281, 3470, 428, 43002, 7599, 11, 51466], avg_logprob=-0.13410686586911863, compression_ratio=1.725552050473186, no_speech_prob=0.00020127756579313427, words=None, temperature=0.0), Segment(id=26, seek=2956, start=51.6, end=53.56, text=' you really should be focusing on things', tokens=[51466, 291, 534, 820, 312, 8416, 322, 721, 51564], avg_logprob=-0.13410686586911863, compression_ratio=1.725552050473186, no_speech_prob=0.00020127756579313427, words=None, temperature=0.0), Segment(id=27, seek=2956, start=53.56, end=55.08, text=' that can improve your vocabulary,', tokens=[51564, 300, 393, 3470, 428, 19864, 11, 51640], avg_logprob=-0.13410686586911863, compression_ratio=1.725552050473186, no_speech_prob=0.00020127756579313427, words=None, temperature=0.0), Segment(id=28, seek=2956, start=55.08, end=57.400000000000006, text=' enhance communication skills, or language use.', tokens=[51640, 11985, 6101, 3942, 11, 420, 2856, 764, 13, 51756], avg_logprob=-0.13410686586911863, compression_ratio=1.725552050473186, no_speech_prob=0.00020127756579313427, words=None, temperature=0.0), Segment(id=29, seek=5740, start=57.4, end=59.56, text=' Just think that encourage effective expression', tokens=[50364, 1449, 519, 300, 5373, 4942, 6114, 50472], avg_logprob=-0.32348013586468166, compression_ratio=1.3114754098360655, no_speech_prob=0.015045053325593472, words=None, temperature=0.0), Segment(id=30, seek=5740, start=59.56, end=61.28, text=' of your thoughts, ideas, feelings,', tokens=[50472, 295, 428, 4598, 11, 3487, 11, 6640, 11, 50558], avg_logprob=-0.32348013586468166, compression_ratio=1.3114754098360655, no_speech_prob=0.015045053325593472, words=None, temperature=0.0), Segment(id=31, seek=5740, start=61.28, end=62.76, text=' through words, which is obviously', tokens=[50558, 807, 2283, 11, 597, 307, 2745, 50632], avg_logprob=-0.32348013586468166, compression_ratio=1.3114754098360655, no_speech_prob=0.015045053325593472, words=None, temperature=0.0), Segment(id=32, seek=5740, start=62.76, end=64.96, text=' a key component for linguistic intelligence.', tokens=[50632, 257, 2141, 6542, 337, 43002, 7599, 13, 50742], avg_logprob=-0.32348013586468166, compression_ratio=1.3114754098360655, no_speech_prob=0.015045053325593472, words=None, temperature=0.0)], 'info': TranscriptionInfo(language='en', language_probability=0.9992296695709229, duration=68.8471875, duration_after_vad=68.8471875, all_language_probs=[('en', 0.9992296695709229), ('ja', 0.00023950620379764587), ('la', 5.771647556684911e-05), ('fr', 5.3572501201415434e-05), ('it', 4.7037770855240524e-05), ('pt', 4.3156385800102726e-05), ('ko', 3.0292634619399905e-05), ('km', 2.8797467166441493e-05), ('haw', 2.8730040867230855e-05), ('es', 2.8094180379412137e-05), ('cy', 2.5281542548327707e-05), ('pl', 1.8966520656249486e-05), ('ru', 1.856472772487905e-05), ('zh', 1.8242968508275226e-05), ('nn', 1.6985255570034496e-05), ('tl', 1.3595827113022096e-05), ('de', 9.89546697383048e-06), ('jw', 9.887524356599897e-06), ('id', 9.385536031913944e-06), ('ar', 9.015908290166408e-06), ('ms', 7.966616976773366e-06), ('tr', 5.577210231422214e-06), ('fi', 5.3035564633319154e-06), ('th', 4.77335788673372e-06), ('sv', 4.174075456830906e-06), ('vi', 3.4509484976297244e-06), ('br', 2.9547522899520118e-06), ('mi', 2.6151253678108333e-06), ('hi', 2.5975077733164653e-06), ('sn', 2.458103153912816e-06), ('no', 2.4526425477233715e-06), ('nl', 2.205016699008411e-06), ('ht', 1.2701385685431887e-06), ('el', 1.263724016098422e-06), ('sa', 9.854975360212848e-07), ('hu', 9.643969178796397e-07), ('ta', 9.412000281372457e-07), ('si', 9.314082944911206e-07), ('yo', 8.984951023194299e-07), ('ml', 7.277866416188772e-07), ('ur', 6.389209943336027e-07), ('da', 6.229584528227861e-07), ('bo', 5.916236887060222e-07), ('bn', 5.729856979996839e-07), ('he', 5.677724743691215e-07), ('yi', 4.3156009610356705e-07), ('fa', 4.220127323151246e-07), ('te', 4.1841565234790323e-07), ('my', 3.536943609105947e-07), ('ca', 3.5099677120342676e-07), ('cs', 3.037658871107851e-07), ('ro', 2.867356840852153e-07), ('bs', 2.8236243565515906e-07), ('sl', 2.4706542944841203e-07), ('sw', 2.1804341088227375e-07), ('hr', 2.1507301539713808e-07), ('mn', 2.0761767416388466e-07), ('uk', 2.0435518877093273e-07), ('be', 1.6185032336579752e-07), ('gl', 1.3636197593314137e-07), ('mt', 1.0386225568481677e-07), ('lo', 9.891117258575832e-08), ('sk', 9.806865364225814e-08), ('eu', 9.734426953400543e-08), ('is', 8.755993974318699e-08), ('lv', 8.627317527043488e-08), ('fo', 8.372319371119374e-08), ('ne', 7.912961308420563e-08), ('af', 6.861603196739452e-08), ('sr', 6.646182981739912e-08), ('lt', 5.940964342698862e-08), ('bg', 5.616451659307131e-08), ('hy', 5.087569476813769e-08), ('oc', 4.301866241007701e-08), ('az', 4.0663113765049275e-08), ('pa', 4.049647372994514e-08), ('kk', 2.913932384274176e-08), ('mr', 2.8213671399157647e-08), ('sd', 2.0249810717132277e-08), ('kn', 1.5957594357018934e-08), ('ps', 1.5271954367790386e-08), ('gu', 1.4350860944034594e-08), ('sq', 1.1971510893715731e-08), ('ka', 1.1738438665531703e-08), ('et', 1.0568711239500317e-08), ('am', 1.0096397495829024e-08), ('as', 7.660071688064818e-09), ('mk', 6.043767264429789e-09), ('so', 5.416699533355995e-09), ('ln', 4.402888720278497e-09), ('lb', 2.3927546610735817e-09), ('su', 1.6137928771087218e-09), ('tg', 1.102317903622918e-09), ('tt', 5.506217148898429e-10), ('ha', 4.90160190214084e-10), ('uz', 1.7640129634788337e-10), ('ba', 1.4442064211195316e-10), ('tk', 1.118114142939497e-10), ('mg', 6.75216063616979e-11)], transcription_options=TranscriptionOptions(beam_size=5, best_of=5, patience=1, length_penalty=1, repetition_penalty=1, no_repeat_ngram_size=0, log_prob_threshold=-1.0, no_speech_threshold=0.6, compression_ratio_threshold=2.4, condition_on_previous_text=True, prompt_reset_on_temperature=0.5, temperatures=[0.0, 0.2, 0.4, 0.6, 0.8, 1.0], initial_prompt=None, prefix=None, suppress_blank=True, suppress_tokens=(1, 2, 7, 8, 9, 10, 14, 25, 26, 27, 28, 29, 31, 58, 59, 60, 61, 62, 63, 90, 91, 92, 93, 359, 503, 522, 542, 873, 893, 902, 918, 922, 931, 1350, 1853, 1982, 2460, 2627, 3246, 3253, 3268, 3536, 3846, 3961, 4183, 4667, 6585, 6647, 7273, 9061, 9383, 10428, 10929, 11938, 12033, 12331, 12562, 13793, 14157, 14635, 15265, 15618, 16553, 16604, 18362, 18956, 20075, 21675, 22520, 26130, 26161, 26435, 28279, 29464, 31650, 32302, 32470, 36865, 42863, 47425, 49870, 50254, 50258, 50358, 50359, 50360, 50361), without_timestamps=False, max_initial_timestamp=1.0, word_timestamps=False, prepend_punctuations='"\'“¿([{-', append_punctuations='"\'.。,，!！?？:：”)]}、', multilingual=False, max_new_tokens=None, clip_timestamps=[0.0], hallucination_silence_threshold=None, hotwords=None), vad_options=None)}

" What's the weirdest word you've come up with that you only share with one other person?  Because studies show that literally every relationship or very good friendship ends up creating their own unique micro-dialect with specific words and grammatical structures.  For example, 75% of adults have reported using some kind of baby-talking relationships, like calling a TV remote of morote, or a melley, or a moto, which are all words that people have said they use with their partner.  But also, sometimes you're just joshing around with your friends and you end up creating a whole new word that you keep referring back to as a silly little goof.  And while they can be a little bit embarrassing, these micro-dialects are actually really healthy.  Research tells us that couples who use baby-talking relationships tend to have happier marriages and more secure attachment styles.  Meanwhile, the opposite is also true. As couples drift apart, their language tends to get less similar.  That's because constructing a private language is a form of social bonding.  By forming new in-joke words from mispronunciations or shared experiences, that idiomatically cement your connections by calling back to a certain good memory.  And while it's beautiful that every two-person relationship ends up creating a language specific to that dynamic,  this also means that, technically speaking, every time a couple breaks up, a language will die out."